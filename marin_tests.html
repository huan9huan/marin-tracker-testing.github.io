<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Marin Tag Tests</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha/css/bootstrap.css">



</head>

<body>
  <div class="controls">


<script>
window.dataLayer = window.dataLayer || []
dataLayer.push({
   'transactionId': '1234',
   'transaction_timestamp': Date.now(),
   'msmid' : readMsmidCookieid() ,
   'transactionAffiliation': 'Acme Clothing',
   'transactionTotal': 38.26,
   'transactionTax': 1.29,
   'transactionShipping': 5,
   'transactionProducts': [{
       'sku': 'DD44',
       'name': 'T-Shirt',
       'category': 'Apparel',
       'price': 11.99,
       'quantity': 1
   },{
       'sku': 'AA1243544',
       'name': 'Socks',
       'category': 'Apparel',
       'price': 9.99,
       'quantity': 2
   }]
});
</script>
</body>

    <!-- Manual Light Controls -->
    <button id="msm_test" class="btn btn-warning">msm button</button>
    <button id="generate_click_control" class="btn btn-warning">Page Reload</button>
    <button id="generate_click_callback" class="btn btn-warning">Generate Click Callback</button>
    <button id="stop_light_control" class="btn btn-danger">Order Test 1</button>
    <button id="case_order_id_example" class="btn btn-success">Order Test 2</button>
    <button id="info_light_control" class="btn btn-info">TBD</button>

  <!-- Automatic Light Controls -->
  <!-- <button id="stop_control" class="btn btn-danger">Stop</button>
  <button id="go_control" class="btn btn-success">Go</button> -->
  <script type='text/javascript'>
  var _mTrack = _mTrack || [];
  _mTrack.push(['trackPage']);

  (function() {
  var mClientId = '24l339123';
  var mProto = (('https:' == document.location.protocol) ? 'https://' : 'http://');
  var mHost = 'tracker.marinsm.com';

  var mt = document.createElement('script'); mt.type = 'text/javascript'; mt.async = true; mt.src = mProto + mHost + '/tracker/async/' + mClientId + '.js';
  var fscr = document.getElementsByTagName('script')[0]; fscr.parentNode.insertBefore(mt, fscr);
  })();
  </script>
  <noscript>
  <img width="1" height="1" src="https://tracker.marinsm.com/tp?act=1&cid=24l339123&script=no" />
  </noscript>

  </div>

<script type='text/javascript'>
    //You can put them in blocks like this (just like <style> tags)...

    var clickButton = document.getElementById('generate_click_control');
    console.log('Generate Click: Test action 1 for s5OV7lY0f');
    clickButton.addEventListener('click',function() {
    insertParam('mkwid', 's5OV7lY0f');
    });

    var test1Button = document.getElementById('stop_light_control');
    console.log('Order Test 1 : Numerical Order ID Test');
    test1Button.addEventListener('click',function() {
    marinConv();
    });



    var Test2Button = document.getElementById('case_order_id_example');
    console.log('Order Test 2 : Numbers + Mixed Case Order ID Test');
    Test2Button.addEventListener('click',function() {
    marinConvMixedCase();
    });


   function marinConv() {
     var track = new Image();
      track.src="https://tracker.marinsm.com/tp?act=2&cid=24l339123&currency=&trans=UTM:I|" + myFunction() + "|order|product|category||";
   }

   function readMsmidCookieid() {
    var x = Math.floor((Math.random() * 10000000) + 1);
    return x;
}

function marinConvMixedCase() {
  var track = new Image();
   track.src="https://tracker.marinsm.com/tp?act=2&cid=24l339123&currency=&trans=UTM:I|" + myFunction() + "aA|order|product|category|50.21|";
}

function insertParam(key, value)
{
  key = encodeURI(key); value = encodeURI(value);

  var kvp = document.location.search.substr(1).split('&');

  var i=kvp.length; var x; while(i--)
  {
      x = kvp[i].split('=');

      if (x[0]==key)
      {
          x[1] = value;
          kvp[i] = x.join('=');
          break;
      }
  }

  if(i<0) {kvp[kvp.length] = [key,value].join('=');}

  //this will reload the page, it's likely better to store this until finished
  document.location.search = kvp.join('&');
}

  </script>

  <!-- BEGIN: Marin Software Tracking Script (Landing Page) -->

  <!-- END: Copyright Marin Software -->

  <script>
  !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
  n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
  document,'script','https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1903651476551913'); // Insert your pixel ID here.
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1903651476551913&ev=PageView&noscript=1"
  /></noscript>
  <!-- DO NOT MODIFY -->
  <!-- End Facebook Pixel Code -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="./js/main.js"></script>

  <!-- Facebook Pixel Code -->

</body>

</html>
